# Modern Pomodoro Timer for Windows

Windows 11のデザインに調和する、軽量かつ高機能なポモドーロタイマーアプリケーションです。
PythonとCustomTkinterを用いて開発されており、作業の邪魔にならない「バーモード」や、集中力を高める「BGM生成機能」、徹底した「ログ管理機能」を備えています。

## ✨ 主な機能

* **モダンなUI**: Windows 11ライクな角丸デザインとダークモード対応。
* **3つの表示モード**:
    * **Main**: 全ての機能にアクセスできる通常モード。
    * **Mini**: 必要最小限の情報だけを表示するコンパクトモード。
    * **Bar**: 画面下部などに配置できる細長いバーモード。マウスでドラッグして好きな位置に移動可能。
* **プリセットタイマー**: Focus (25分/50分) と Break (5分/15分) をワンクリックで切り替え。
* **BGM再生機能**:
    * 集中を助ける3種類のノイズ（ホワイト、ピンク、ブラウン）を**プログラムが自動生成**して再生。
    * `sounds` フォルダに任意のmp3ファイルを入れれば、独自の環境音も追加可能。
* **タスク記録 & ログ管理**:
    * 作業内容（タスク名）と時間をデータベースに記録。
    * **CSVエクスポート**: 蓄積されたログを `exports` フォルダに出力し、**出力後にアプリ内の履歴をクリア**します（アーカイブ仕様）。
* **通知機能**: タイマー終了時にWindows標準のトースト通知とアラーム音でお知らせ。
* **ウィンドウ制御**: 常に最前面に固定する機能や、モード切替時にウィンドウを画面中央に自動配置する機能を搭載。

## 🛠 動作環境

* **OS**: Windows 10 / 11 (※通知機能に `winotify` を使用しているためWindows専用です)
* **言語**: Python 3.x
* **依存ライブラリ**:
    * `customtkinter`: GUI
    * `pygame-ce`: 音声再生 (標準のpygameではなく、互換性の高いce版を使用)
    * `winotify`: Windows通知
    * `sqlite3`, `winsound`: 標準ライブラリ

## 📦 インストール方法

### 1. リポジトリのクローン
このリポジトリのファイルを任意のフォルダに配置してください。

### 2. 仮想環境の作成 (推奨)
コマンドプロンプトまたはPowerShellで、プロジェクトフォルダにて以下を実行します。

```bash
python -m venv .venv
.venv\Scripts\activate
````

### 3\. ライブラリのインストール

`requirements.txt` を作成し、以下の内容を記述してください。

**requirements.txt**

```text
customtkinter
winotify
pygame-ce
```

その後、以下のコマンドでインストールします。

```bash
pip install -r requirements.txt
```

> **注意**: Python 3.11以降を使用している場合、標準の `pygame` ではインストールエラーが発生することがあります。必ず **`pygame-ce`** を指定してください。

## 🚀 使い方

### アプリの起動

仮想環境が有効な状態で以下を実行します。

```bash
python pomodoro.py
```

または、付属の `start.bat` をダブルクリックするだけで起動可能です。

### 各モードの操作

  * **Mini / Barモードへの切替**: メイン画面のボタンから切り替えます。
  * **Barモードの移動**: バーの背景部分をドラッグアンドドロップすると、画面上の好きな位置に配置できます。
  * **通常モードへの復帰**: 各モードにある「拡大（⤢）」ボタンを押すと、メインウィンドウが**画面中央**に戻ります。

### CSVエクスポートの仕様

  * 「History」タブの「CSV出力」ボタンを押すと、`exports/` フォルダが自動作成され、日時付きのファイル名で保存されます。
  * **重要**: CSVが出力されると、**アプリ上の表示履歴（データベース）は削除**されます。これにより、データの重複保存を防ぎ、常に新しいデータのみを管理できます。

## 📂 ファイル構成とGit管理

リポジトリをクリーンに保つため、以下のファイル・フォルダは `.gitignore` に追加することを推奨します。

```gitignore
# 仮想環境
.venv/

# ログ・データ
work_log.db
exports/

# 自動生成されるノイズ音声
*_noise.wav

# コンパイルキャッシュ
__pycache__/
*.spec
dist/
build/
```

## 🔧 アプリケーション化（Exe化）

Python環境がないPCで配布・実行したい場合は、PyInstallerを使用します。

```bash
pip install pyinstaller
pyinstaller --noconsole --onefile pomodoro.py
```

生成された `dist/pomodoro.exe` を使用してください。
※ `pomodoro.exe` を移動させる場合は、ログファイル（`work_log.db`）がexeと同じ場所に生成される点にご注意ください。